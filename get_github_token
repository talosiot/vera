#!/usr/bin/env bash

help() {
    echo "Retrieve your github personal access token from aws secret"
    echo "And sets the GITHUB_TOKEN environment variable"
    echo "-u github username"
    exit 1
}

while getopts ":u:" arg; do
    case $arg in
        u) GITHUBUSER=$OPTARG;;
        *) help ;;
    esac
done

[ -z "$GITHUBUSER" ] && help
[ -z "$VERA_HOME" ] && echo "Must source vera/sethome first" && exit 1

SECRET_NAME="$GITHUBUSER@github.com/token"
echo $($VERA_HOME/get -n $SECRET_NAME)
